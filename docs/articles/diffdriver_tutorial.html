<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A tutorial to run diffdriver • diffdriver</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A tutorial to run diffdriver">
<meta property="og:description" content="diffdriver">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diffdriver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/diffdriver_tutorial.html">A tutorial to run diffdriver</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/simingz/ctwas" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A tutorial to run diffdriver</h1>
            
      
      
      <div class="hidden name"><code>diffdriver_tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="environment-requirement">Environment requirement<a class="anchor" aria-label="anchor" href="#environment-requirement"></a>
</h2>
<p>Need 16G memory to run diffdriver. The place that need the most
memory is for parameter estimation for background mutation rate.</p>
</div>
<div class="section level2">
<h2 id="prepare-input">Prepare input<a class="anchor" aria-label="anchor" href="#prepare-input"></a>
</h2>
<ul>
<li>Gene file</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genef</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_gene.txt"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">genef</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       V1</span></span>
<span><span class="co">#&gt; 1   TP53</span></span>
<span><span class="co">#&gt; 2 PIK3CA</span></span></code></pre></div>
<ul>
<li>Mutation file</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mutf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"example_mutations.txt"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">mutf</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt;   Chromosome  Position Ref Alt                     SampleID</span></span>
<span><span class="co">#&gt; 1         19  55653236   C   T TCGA-N6-A4VE-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 2         17  65134211   C   T TCGA-NA-A4R1-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 3         20  30354424   G   T TCGA-N8-A4PM-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 4          6  18215312   G   C TCGA-N8-A4PO-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 5          1 154186393   C   G TCGA-NA-A4R0-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 6         10  23003128   C   A TCGA-NF-A4X2-01A-11D-A28R-08</span></span></code></pre></div>
<ul>
<li>Phenotype file</li>
</ul>
<p>Note: Nsyn is only required for when running diffdriver with mode
“regular”. TODO: update regular BMR so that this is not used.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phenof</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"example_phenotypes.txt"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">phenof</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       SampleID SmokingCessation Nsyn</span></span>
<span><span class="co">#&gt; 1 TCGA-N5-A4R8-01A-11D-A28R-08        0.5319630    7</span></span>
<span><span class="co">#&gt; 2 TCGA-N5-A4RD-01A-11D-A28R-08        0.0448991    8</span></span>
<span><span class="co">#&gt; 3 TCGA-N5-A4RF-01A-11D-A28R-08       -0.3140750    7</span></span>
<span><span class="co">#&gt; 4 TCGA-N5-A4RJ-01A-11D-A28R-08        0.4229920    8</span></span>
<span><span class="co">#&gt; 5 TCGA-N5-A4RM-01A-11D-A28R-08       -0.2830070   12</span></span>
<span><span class="co">#&gt; 6 TCGA-N5-A4RN-01A-12D-A28R-08        0.7874080   14</span></span></code></pre></div>
<ul>
<li>Background mutation file</li>
</ul>
<p>TODO: add description about how to generate a background mutation
file from driverMAPS output/ generate within diffdriver.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmrf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"example_BMRlist.Rd"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">bmrf</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Hotspot file</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hotf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"example_hotspot.txt"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">hotf</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   chrom   start</span></span>
<span><span class="co">#&gt; 1 chr17 7577120</span></span>
<span><span class="co">#&gt; 2 chr17 7577538</span></span>
<span><span class="co">#&gt; 3 chr17 7577559</span></span>
<span><span class="co">#&gt; 4 chr17 7578271</span></span>
<span><span class="co">#&gt; 5 chr17 7578394</span></span>
<span><span class="co">#&gt; 6 chr17 7578406</span></span></code></pre></div>
<ul>
<li>Directory that contains annotation files We have two types of
annotations, one has 96 annotation files:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annodir</span> <span class="op">=</span> <span class="st">"~/temp/annodir96"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">annodir</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "TCGA-UCS"                       "TCGA-UCS_nttype10_annodata.txt"</span></span>
<span><span class="co">#&gt;   [3] "TCGA-UCS_nttype11_annodata.txt" "TCGA-UCS_nttype12_annodata.txt"</span></span>
<span><span class="co">#&gt;   [5] "TCGA-UCS_nttype13_annodata.txt" "TCGA-UCS_nttype14_annodata.txt"</span></span>
<span><span class="co">#&gt;   [7] "TCGA-UCS_nttype15_annodata.txt" "TCGA-UCS_nttype16_annodata.txt"</span></span>
<span><span class="co">#&gt;   [9] "TCGA-UCS_nttype17_annodata.txt" "TCGA-UCS_nttype18_annodata.txt"</span></span>
<span><span class="co">#&gt;  [11] "TCGA-UCS_nttype19_annodata.txt" "TCGA-UCS_nttype1_annodata.txt" </span></span>
<span><span class="co">#&gt;  [13] "TCGA-UCS_nttype20_annodata.txt" "TCGA-UCS_nttype21_annodata.txt"</span></span>
<span><span class="co">#&gt;  [15] "TCGA-UCS_nttype22_annodata.txt" "TCGA-UCS_nttype23_annodata.txt"</span></span>
<span><span class="co">#&gt;  [17] "TCGA-UCS_nttype24_annodata.txt" "TCGA-UCS_nttype25_annodata.txt"</span></span>
<span><span class="co">#&gt;  [19] "TCGA-UCS_nttype26_annodata.txt" "TCGA-UCS_nttype27_annodata.txt"</span></span>
<span><span class="co">#&gt;  [21] "TCGA-UCS_nttype28_annodata.txt" "TCGA-UCS_nttype29_annodata.txt"</span></span>
<span><span class="co">#&gt;  [23] "TCGA-UCS_nttype2_annodata.txt"  "TCGA-UCS_nttype30_annodata.txt"</span></span>
<span><span class="co">#&gt;  [25] "TCGA-UCS_nttype31_annodata.txt" "TCGA-UCS_nttype32_annodata.txt"</span></span>
<span><span class="co">#&gt;  [27] "TCGA-UCS_nttype33_annodata.txt" "TCGA-UCS_nttype34_annodata.txt"</span></span>
<span><span class="co">#&gt;  [29] "TCGA-UCS_nttype35_annodata.txt" "TCGA-UCS_nttype36_annodata.txt"</span></span>
<span><span class="co">#&gt;  [31] "TCGA-UCS_nttype37_annodata.txt" "TCGA-UCS_nttype38_annodata.txt"</span></span>
<span><span class="co">#&gt;  [33] "TCGA-UCS_nttype39_annodata.txt" "TCGA-UCS_nttype3_annodata.txt" </span></span>
<span><span class="co">#&gt;  [35] "TCGA-UCS_nttype40_annodata.txt" "TCGA-UCS_nttype41_annodata.txt"</span></span>
<span><span class="co">#&gt;  [37] "TCGA-UCS_nttype42_annodata.txt" "TCGA-UCS_nttype43_annodata.txt"</span></span>
<span><span class="co">#&gt;  [39] "TCGA-UCS_nttype44_annodata.txt" "TCGA-UCS_nttype45_annodata.txt"</span></span>
<span><span class="co">#&gt;  [41] "TCGA-UCS_nttype46_annodata.txt" "TCGA-UCS_nttype47_annodata.txt"</span></span>
<span><span class="co">#&gt;  [43] "TCGA-UCS_nttype48_annodata.txt" "TCGA-UCS_nttype49_annodata.txt"</span></span>
<span><span class="co">#&gt;  [45] "TCGA-UCS_nttype4_annodata.txt"  "TCGA-UCS_nttype50_annodata.txt"</span></span>
<span><span class="co">#&gt;  [47] "TCGA-UCS_nttype51_annodata.txt" "TCGA-UCS_nttype52_annodata.txt"</span></span>
<span><span class="co">#&gt;  [49] "TCGA-UCS_nttype53_annodata.txt" "TCGA-UCS_nttype54_annodata.txt"</span></span>
<span><span class="co">#&gt;  [51] "TCGA-UCS_nttype55_annodata.txt" "TCGA-UCS_nttype56_annodata.txt"</span></span>
<span><span class="co">#&gt;  [53] "TCGA-UCS_nttype57_annodata.txt" "TCGA-UCS_nttype58_annodata.txt"</span></span>
<span><span class="co">#&gt;  [55] "TCGA-UCS_nttype59_annodata.txt" "TCGA-UCS_nttype5_annodata.txt" </span></span>
<span><span class="co">#&gt;  [57] "TCGA-UCS_nttype60_annodata.txt" "TCGA-UCS_nttype61_annodata.txt"</span></span>
<span><span class="co">#&gt;  [59] "TCGA-UCS_nttype62_annodata.txt" "TCGA-UCS_nttype63_annodata.txt"</span></span>
<span><span class="co">#&gt;  [61] "TCGA-UCS_nttype64_annodata.txt" "TCGA-UCS_nttype65_annodata.txt"</span></span>
<span><span class="co">#&gt;  [63] "TCGA-UCS_nttype66_annodata.txt" "TCGA-UCS_nttype67_annodata.txt"</span></span>
<span><span class="co">#&gt;  [65] "TCGA-UCS_nttype68_annodata.txt" "TCGA-UCS_nttype69_annodata.txt"</span></span>
<span><span class="co">#&gt;  [67] "TCGA-UCS_nttype6_annodata.txt"  "TCGA-UCS_nttype70_annodata.txt"</span></span>
<span><span class="co">#&gt;  [69] "TCGA-UCS_nttype71_annodata.txt" "TCGA-UCS_nttype72_annodata.txt"</span></span>
<span><span class="co">#&gt;  [71] "TCGA-UCS_nttype73_annodata.txt" "TCGA-UCS_nttype74_annodata.txt"</span></span>
<span><span class="co">#&gt;  [73] "TCGA-UCS_nttype75_annodata.txt" "TCGA-UCS_nttype76_annodata.txt"</span></span>
<span><span class="co">#&gt;  [75] "TCGA-UCS_nttype77_annodata.txt" "TCGA-UCS_nttype78_annodata.txt"</span></span>
<span><span class="co">#&gt;  [77] "TCGA-UCS_nttype79_annodata.txt" "TCGA-UCS_nttype7_annodata.txt" </span></span>
<span><span class="co">#&gt;  [79] "TCGA-UCS_nttype80_annodata.txt" "TCGA-UCS_nttype81_annodata.txt"</span></span>
<span><span class="co">#&gt;  [81] "TCGA-UCS_nttype82_annodata.txt" "TCGA-UCS_nttype83_annodata.txt"</span></span>
<span><span class="co">#&gt;  [83] "TCGA-UCS_nttype84_annodata.txt" "TCGA-UCS_nttype85_annodata.txt"</span></span>
<span><span class="co">#&gt;  [85] "TCGA-UCS_nttype86_annodata.txt" "TCGA-UCS_nttype87_annodata.txt"</span></span>
<span><span class="co">#&gt;  [87] "TCGA-UCS_nttype88_annodata.txt" "TCGA-UCS_nttype89_annodata.txt"</span></span>
<span><span class="co">#&gt;  [89] "TCGA-UCS_nttype8_annodata.txt"  "TCGA-UCS_nttype90_annodata.txt"</span></span>
<span><span class="co">#&gt;  [91] "TCGA-UCS_nttype91_annodata.txt" "TCGA-UCS_nttype92_annodata.txt"</span></span>
<span><span class="co">#&gt;  [93] "TCGA-UCS_nttype93_annodata.txt" "TCGA-UCS_nttype94_annodata.txt"</span></span>
<span><span class="co">#&gt;  [95] "TCGA-UCS_nttype95_annodata.txt" "TCGA-UCS_nttype96_annodata.txt"</span></span>
<span><span class="co">#&gt;  [97] "TCGA-UCS_nttype9_annodata.txt"  "config_annotation.txt"         </span></span>
<span><span class="co">#&gt;  [99] "data"                           "nttype1_annodata.txt"</span></span></code></pre></div>
<p>One has 9 annotation files:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annodir</span> <span class="op">=</span> <span class="st">"~/temp/annodir9"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">annodir</span>, pattern <span class="op">=</span> <span class="st">"_annodata.txt"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nttype1_annodata.txt" "nttype2_annodata.txt" "nttype3_annodata.txt"</span></span>
<span><span class="co">#&gt; [4] "nttype4_annodata.txt" "nttype5_annodata.txt" "nttype6_annodata.txt"</span></span>
<span><span class="co">#&gt; [7] "nttype7_annodata.txt" "nttype8_annodata.txt" "nttype9_annodata.txt"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-diffdriver">Run diffdriver<a class="anchor" aria-label="anchor" href="#run-diffdriver"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">diffdriver</span><span class="op">)</span></span>
<span><span class="va">outputdir</span> <span class="op">&lt;-</span> <span class="st">"~/temp/output"</span></span></code></pre></div>
<p>With signature adjustment, takes around 10min for two genes. Each
additional gene will take 3-4 minutes. Please use the provide the
annotation folder with 96 annotation files. <code>j</code> is the column
that will be used as the phenotype, e.g j=2 means the second column in
the phenotype file will be used as phenotype.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffdriver.html">diffdriver</a></span><span class="op">(</span><span class="va">genef</span>, <span class="va">mutf</span>, <span class="va">phenof</span>, <span class="va">bmrf</span>, j <span class="op">=</span> <span class="fl">2</span>, <span class="va">hotf</span>, annodir <span class="op">=</span> <span class="st">"~/temp/annodir96"</span>, k<span class="op">=</span><span class="fl">6</span>, BMRmode <span class="op">=</span> <span class="st">"signature"</span>, outputdir <span class="op">=</span> <span class="va">outputdir</span>, outputname <span class="op">=</span> <span class="st">"testdiffdriver_sig"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Infer parameters in background mutation rate model, adjusting for inter individual mutational signature difference ..."</span></span>
<span><span class="co">#&gt; Initializing factors using Topic SCORE algorithm.</span></span>
<span><span class="co">#&gt; Topic SCORE failure occurred; using random initialization instead.</span></span>
<span><span class="co">#&gt; Fitting rank-6 Poisson NMF to 54 x 96 dense matrix.</span></span>
<span><span class="co">#&gt; Running 100 SCD updates, without extrapolation (fastTopics 0.6-158).</span></span>
<span><span class="co">#&gt; [1] "coding..."</span></span>
<span><span class="co">#&gt; [1] "processing ..."</span></span>
<span><span class="co">#&gt; [1] "for qnvars, filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "for cvars (0/1 categories), filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "normalizing categorical variables in annotation matrix ..."</span></span>
<span><span class="co">#&gt; [1] "Start to read in data for target genes ..."</span></span>
<span><span class="co">#&gt; [1] "coding..."</span></span>
<span><span class="co">#&gt; [1] "processing ..."</span></span>
<span><span class="co">#&gt; [1] "for qnvars, filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "for cvars (0/1 categories), filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "normalizing categorical variables in annotation matrix ..."</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: PIK3CA"</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: TP53"</span></span>
<span><span class="co">#&gt; [1] "Finished."</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt;              dd.p       mlr.p    mlr.v2.p  fisher.p   binom.p      lr.p</span></span>
<span><span class="co">#&gt; PIK3CA 0.01380985 0.013703216 0.012687921 0.5576717 0.4534890 0.1443223</span></span>
<span><span class="co">#&gt; TP53   0.68904745 0.001886219 0.002017777 0.4788673 0.2359634 0.9942554</span></span>
<span><span class="co">#&gt;           dd.fdr     mlr.fdr  mlr.v2.fdr fisher.fdr binom.fdr    lr.fdr mut.E1</span></span>
<span><span class="co">#&gt; PIK3CA 0.0276197 0.013703216 0.012687921  0.5576717  0.453489 0.2886446      7</span></span>
<span><span class="co">#&gt; TP53   0.6890474 0.003772438 0.004035553  0.5576717  0.453489 0.9942554     23</span></span>
<span><span class="co">#&gt;        mut.E0 E1 E0</span></span>
<span><span class="co">#&gt; PIK3CA      9 22 18</span></span>
<span><span class="co">#&gt; TP53       12 22 18</span></span></code></pre></div>
<p>Without signature adjustment, takes around 5min for two genes. Each
additional gene will take 2 minutes.Please use the provide the
annotation folder with 9 annotation files.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffdriver.html">diffdriver</a></span><span class="op">(</span><span class="va">genef</span>, <span class="va">mutf</span>, <span class="va">phenof</span>, <span class="va">bmrf</span>, j <span class="op">=</span> <span class="fl">2</span>, <span class="va">hotf</span>, annodir <span class="op">=</span> <span class="st">"~/temp/annodir9"</span>, BMRmode <span class="op">=</span> <span class="st">"regular"</span>, outputdir <span class="op">=</span> <span class="va">outputdir</span>, outputname <span class="op">=</span> <span class="st">"testdiffdriver_reg"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Start to read in data for target genes ..."</span></span>
<span><span class="co">#&gt; [1] "coding..."</span></span>
<span><span class="co">#&gt; [1] "processing ..."</span></span>
<span><span class="co">#&gt; [1] "for qnvars, filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "for cvars (0/1 categories), filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "normalizing categorical variables in annotation matrix ..."</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: PIK3CA"</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: TP53"</span></span>
<span><span class="co">#&gt; [1] "Finished."</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt;              dd.p       mlr.p    mlr.v2.p  fisher.p   binom.p      lr.p</span></span>
<span><span class="co">#&gt; PIK3CA 0.03007682 0.013703216 0.012687921 0.5576717 0.4534890 0.1443223</span></span>
<span><span class="co">#&gt; TP53   1.00000000 0.001886219 0.002017777 0.4788673 0.2359634 0.9942554</span></span>
<span><span class="co">#&gt;            dd.fdr     mlr.fdr  mlr.v2.fdr fisher.fdr binom.fdr    lr.fdr mut.E1</span></span>
<span><span class="co">#&gt; PIK3CA 0.06015364 0.013703216 0.012687921  0.5576717  0.453489 0.2886446      7</span></span>
<span><span class="co">#&gt; TP53   1.00000000 0.003772438 0.004035553  0.5576717  0.453489 0.9942554     23</span></span>
<span><span class="co">#&gt;        mut.E0 E1 E0</span></span>
<span><span class="co">#&gt; PIK3CA      9 22 18</span></span>
<span><span class="co">#&gt; TP53       12 22 18</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-specific-genes">Plot specific genes<a class="anchor" aria-label="anchor" href="#plot-specific-genes"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outputdir</span>,<span class="st">"testdiffdriver_reg_SmokingCessation_resdd.Rd"</span><span class="op">)</span><span class="op">)</span>     <span class="co"># load the output file from diffdriver.</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="st">"PIK3CA"</span> <span class="co"># only need to change gene name.</span></span>
<span><span class="va">rig</span> <span class="op">&lt;-</span> <span class="va">riallg</span><span class="op">[[</span><span class="va">g</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">rig</span><span class="op">$</span><span class="va">ridx</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">rig</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">muts</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">mutf</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'chr'</span>, <span class="va">muts</span><span class="op">$</span><span class="va">Chromosome</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, fixed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="va">muts</span><span class="op">$</span><span class="va">Chromosome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>,<span class="va">muts</span><span class="op">$</span><span class="va">Chromosome</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">muti</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">ci</span><span class="op">[</span><span class="va">rig</span><span class="op">[</span><span class="va">muts</span>, on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chrom"</span><span class="op">=</span> <span class="st">"Chromosome"</span>, <span class="st">"start"</span> <span class="op">=</span> <span class="st">"Position"</span>,  <span class="st">"ref"</span> <span class="op">=</span> <span class="st">"Ref"</span>,  <span class="st">"alt"</span><span class="op">=</span> <span class="st">"Alt"</span><span class="op">)</span><span class="op">]</span>, on <span class="op">=</span> <span class="st">"SampleID"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mutmtx</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseMatrix.html" class="external-link">sparseMatrix</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">muti</span><span class="op">$</span><span class="va">ridx</span>, j <span class="op">=</span> <span class="va">muti</span><span class="op">$</span><span class="va">cidx</span>, dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rig</span><span class="op">$</span><span class="va">ridx</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ci</span><span class="op">$</span><span class="va">cidx</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bmrmtx</span><span class="op">=</span> <span class="va">bmrallg</span><span class="op">[[</span><span class="va">g</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ganno</span> <span class="op">&lt;-</span> <span class="va">fannoallg</span><span class="op">[[</span><span class="va">g</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu">diffdriver</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mut.html">plot_mut</a></span><span class="op">(</span>mutmtx<span class="op">=</span><span class="va">mutmtx</span>, canno<span class="op">=</span><span class="va">e</span>, bmrmtx<span class="op">=</span><span class="va">bmrmtx</span>, ganno<span class="op">=</span><span class="va">ganno</span><span class="op">)</span></span></code></pre></div>
<p><img src="diffdriver_tutorial_files/figure-html/plot-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.1.0 (2021-05-18)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: CentOS Linux 7 (Core)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /software/R-4.1.0-no-openblas-el7-x86_64/lib64/R/lib/libRblas.so</span></span>
<span><span class="co">#&gt; LAPACK: /software/R-4.1.0-no-openblas-el7-x86_64/lib64/R/lib/libRlapack.so</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C         LC_TIME=C           </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C         LC_MONETARY=C        LC_MESSAGES=C       </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C        </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C       LC_MEASUREMENT=C     LC_IDENTIFICATION=C </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] diffdriver_0.1.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] mcmc_0.9-7         matrixStats_0.59.0 fs_1.6.1           progress_1.2.2    </span></span>
<span><span class="co">#&gt;  [5] httr_1.4.2         rprojroot_2.0.2    tools_4.1.0        bslib_0.4.2       </span></span>
<span><span class="co">#&gt;  [9] utf8_1.2.1         R6_2.5.0           irlba_2.3.3        uwot_0.1.10       </span></span>
<span><span class="co">#&gt; [13] DBI_1.1.1          lazyeval_0.2.2     colorspace_2.0-2   tidyselect_1.1.1  </span></span>
<span><span class="co">#&gt; [17] prettyunits_1.1.1  compiler_4.1.0     textshaping_0.3.6  cli_3.6.1         </span></span>
<span><span class="co">#&gt; [21] quantreg_5.86      profileModel_0.6.1 SparseM_1.81       desc_1.4.2        </span></span>
<span><span class="co">#&gt; [25] plotly_4.9.4.1     sass_0.4.0         scales_1.1.1       SQUAREM_2021.1    </span></span>
<span><span class="co">#&gt; [29] brglm_0.7.2        quadprog_1.5-8     pbapply_1.4-3      pkgdown_2.0.7     </span></span>
<span><span class="co">#&gt; [33] mixsqp_0.3-48      systemfonts_1.0.4  stringr_1.4.0      digest_0.6.27     </span></span>
<span><span class="co">#&gt; [37] rmarkdown_2.21     MCMCpack_1.6-3     pkgconfig_2.0.3    htmltools_0.5.5   </span></span>
<span><span class="co">#&gt; [41] fastTopics_0.6-158 highr_0.9          fastmap_1.1.0      invgamma_1.1      </span></span>
<span><span class="co">#&gt; [45] htmlwidgets_1.5.3  rlang_1.1.0        rstudioapi_0.13    jquerylib_0.1.4   </span></span>
<span><span class="co">#&gt; [49] generics_0.1.0     jsonlite_1.7.2     dplyr_1.0.7        magrittr_2.0.1    </span></span>
<span><span class="co">#&gt; [53] Matrix_1.3-3       Rcpp_1.0.9         munsell_0.5.0      fansi_0.5.0       </span></span>
<span><span class="co">#&gt; [57] lifecycle_1.0.3    stringi_1.6.2      yaml_2.2.1         MASS_7.3-54       </span></span>
<span><span class="co">#&gt; [61] Rtsne_0.15         grid_4.1.0         parallel_4.1.0     ggrepel_0.9.1     </span></span>
<span><span class="co">#&gt; [65] crayon_1.5.2       lattice_0.20-44    cowplot_1.1.1      hms_1.1.0         </span></span>
<span><span class="co">#&gt; [69] knitr_1.42         pillar_1.6.1       glue_1.4.2         evaluate_0.20     </span></span>
<span><span class="co">#&gt; [73] data.table_1.14.0  RcppParallel_5.1.4 vctrs_0.3.8        MatrixModels_0.5-0</span></span>
<span><span class="co">#&gt; [77] gtable_0.3.0       purrr_0.3.4        tidyr_1.1.3        assertthat_0.2.1  </span></span>
<span><span class="co">#&gt; [81] ashr_2.2-54        cachem_1.0.5       ggplot2_3.3.5      xfun_0.38         </span></span>
<span><span class="co">#&gt; [85] coda_0.19-4        ragg_1.2.5         viridisLite_0.4.0  truncnorm_1.0-9   </span></span>
<span><span class="co">#&gt; [89] tibble_3.1.2       conquer_1.0.2      memoise_2.0.1      ellipsis_0.3.2</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
