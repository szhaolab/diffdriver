<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A tutorial to run diffdriver • diffdriver</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A tutorial to run diffdriver">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diffdriver</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/diffdriver_tutorial.html">A tutorial to run diffdriver</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/szhaolab/diffdriver/" class="external-link">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A tutorial to run diffdriver</h1>
            
      

      <div class="hidden name"><code>diffdriver_tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="environmental-requirement">Environmental requirement<a class="anchor" aria-label="anchor" href="#environmental-requirement"></a>
</h2>
<p>Need 16G memory to run diffdriver. The place that needs the most memory is the parameter estimation for background mutation rate model.</p>
</div>
<div class="section level2">
<h2 id="prepare-input">Prepare input<a class="anchor" aria-label="anchor" href="#prepare-input"></a>
</h2>
<p>Diffdriver requires three datasets from the user: phenotype or context of each individual tumor sample, somatic mutations identified from tumor samples and a list of driver gene names. Diffdriver will test the association between the phenotype/context with selection strength of each provided driver gene.</p>
<ul>
<li>Phenotype/Context</li>
</ul>
<p>Diffdriver needs phenotype or context of each individual tumor sample. A data frame should provided, in this data frame the first column is sample ID with column name “SampleID”, the second column is phenotype or context with the phenotype or context name as column name (note no space or in tab in column names are allowed). See an example below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phenof</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"example_phenotypes.txt"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">phenof</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       SampleID SmokingCessation</span></span>
<span><span class="co">#&gt; 1 TCGA-N5-A4R8-01A-11D-A28R-08        0.5319630</span></span>
<span><span class="co">#&gt; 2 TCGA-N5-A4RD-01A-11D-A28R-08        0.0448991</span></span>
<span><span class="co">#&gt; 3 TCGA-N5-A4RF-01A-11D-A28R-08       -0.3140750</span></span>
<span><span class="co">#&gt; 4 TCGA-N5-A4RJ-01A-11D-A28R-08        0.4229920</span></span>
<span><span class="co">#&gt; 5 TCGA-N5-A4RM-01A-11D-A28R-08       -0.2830070</span></span>
<span><span class="co">#&gt; 6 TCGA-N5-A4RN-01A-12D-A28R-08        0.7874080</span></span></code></pre></div>
<ul>
<li>Driver genes</li>
</ul>
<p>A vector of driver gene names. Diffdriver will test the association for each gene.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genef</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_gene.txt"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">genef</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span></span>
<span><span class="co">#&gt;       V1</span></span>
<span><span class="co">#&gt; 1   CHD4</span></span>
<span><span class="co">#&gt; 2 PIK3CA</span></span></code></pre></div>
<ul>
<li>Somatic mutations</li>
</ul>
<p>Diffdriver needs the somatic mutations identified for each tumor samples. Note this should include all somatic mutations identified, not just the ones in selected driver genes. Somatic mutations will be used to estimate background mutation rate and selection strength for selected genes. A data frame should be provided, see below for colnames of this data frame and example mutations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mutf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/"</span>, <span class="st">"example_mutations.txt"</span>, package <span class="op">=</span> <span class="st">"diffdriver"</span><span class="op">)</span></span>
<span><span class="va">mut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">mutf</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mut</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Chromosome  Position Ref Alt                     SampleID</span></span>
<span><span class="co">#&gt; 1         19  55653236   C   T TCGA-N6-A4VE-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 2         17  65134211   C   T TCGA-NA-A4R1-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 3         20  30354424   G   T TCGA-N8-A4PM-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 4          6  18215312   G   C TCGA-N8-A4PO-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 5          1 154186393   C   G TCGA-NA-A4R0-01A-11D-A28R-08</span></span>
<span><span class="co">#&gt; 6         10  23003128   C   A TCGA-NF-A4X2-01A-11D-A28R-08</span></span></code></pre></div>
<p>In addition to these datasets provided by the user, diffdriver also needs annotation files. See the package installation page for download links to these annotation files. Unless the number of tumor samples or number of mutations is very small, we suggest to use the 96-annotation files. Please download these files to a folder and provide the folder address to diffdriver.</p>
<ul>
<li>Directory that contains annotation files</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annodir</span> <span class="op">=</span> <span class="st">"~/temp/annodir96"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">annodir</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "anno96_nttype1_annodata.txt"  "anno96_nttype10_annodata.txt"</span></span>
<span><span class="co">#&gt;  [3] "anno96_nttype11_annodata.txt" "anno96_nttype12_annodata.txt"</span></span>
<span><span class="co">#&gt;  [5] "anno96_nttype13_annodata.txt" "anno96_nttype14_annodata.txt"</span></span>
<span><span class="co">#&gt;  [7] "anno96_nttype15_annodata.txt" "anno96_nttype16_annodata.txt"</span></span>
<span><span class="co">#&gt;  [9] "anno96_nttype17_annodata.txt" "anno96_nttype18_annodata.txt"</span></span>
<span><span class="co">#&gt; [11] "anno96_nttype19_annodata.txt" "anno96_nttype2_annodata.txt" </span></span>
<span><span class="co">#&gt; [13] "anno96_nttype20_annodata.txt" "anno96_nttype21_annodata.txt"</span></span>
<span><span class="co">#&gt; [15] "anno96_nttype22_annodata.txt" "anno96_nttype23_annodata.txt"</span></span>
<span><span class="co">#&gt; [17] "anno96_nttype24_annodata.txt" "anno96_nttype25_annodata.txt"</span></span>
<span><span class="co">#&gt; [19] "anno96_nttype26_annodata.txt" "anno96_nttype27_annodata.txt"</span></span>
<span><span class="co">#&gt; [21] "anno96_nttype28_annodata.txt" "anno96_nttype29_annodata.txt"</span></span>
<span><span class="co">#&gt; [23] "anno96_nttype3_annodata.txt"  "anno96_nttype30_annodata.txt"</span></span>
<span><span class="co">#&gt; [25] "anno96_nttype31_annodata.txt" "anno96_nttype32_annodata.txt"</span></span>
<span><span class="co">#&gt; [27] "anno96_nttype33_annodata.txt" "anno96_nttype34_annodata.txt"</span></span>
<span><span class="co">#&gt; [29] "anno96_nttype35_annodata.txt" "anno96_nttype36_annodata.txt"</span></span>
<span><span class="co">#&gt; [31] "anno96_nttype37_annodata.txt" "anno96_nttype38_annodata.txt"</span></span>
<span><span class="co">#&gt; [33] "anno96_nttype39_annodata.txt" "anno96_nttype4_annodata.txt" </span></span>
<span><span class="co">#&gt; [35] "anno96_nttype40_annodata.txt" "anno96_nttype41_annodata.txt"</span></span>
<span><span class="co">#&gt; [37] "anno96_nttype42_annodata.txt" "anno96_nttype43_annodata.txt"</span></span>
<span><span class="co">#&gt; [39] "anno96_nttype44_annodata.txt" "anno96_nttype45_annodata.txt"</span></span>
<span><span class="co">#&gt; [41] "anno96_nttype46_annodata.txt" "anno96_nttype47_annodata.txt"</span></span>
<span><span class="co">#&gt; [43] "anno96_nttype48_annodata.txt" "anno96_nttype49_annodata.txt"</span></span>
<span><span class="co">#&gt; [45] "anno96_nttype5_annodata.txt"  "anno96_nttype50_annodata.txt"</span></span>
<span><span class="co">#&gt; [47] "anno96_nttype51_annodata.txt" "anno96_nttype52_annodata.txt"</span></span>
<span><span class="co">#&gt; [49] "anno96_nttype53_annodata.txt" "anno96_nttype54_annodata.txt"</span></span>
<span><span class="co">#&gt; [51] "anno96_nttype55_annodata.txt" "anno96_nttype56_annodata.txt"</span></span>
<span><span class="co">#&gt; [53] "anno96_nttype57_annodata.txt" "anno96_nttype58_annodata.txt"</span></span>
<span><span class="co">#&gt; [55] "anno96_nttype59_annodata.txt" "anno96_nttype6_annodata.txt" </span></span>
<span><span class="co">#&gt; [57] "anno96_nttype60_annodata.txt" "anno96_nttype61_annodata.txt"</span></span>
<span><span class="co">#&gt; [59] "anno96_nttype62_annodata.txt" "anno96_nttype63_annodata.txt"</span></span>
<span><span class="co">#&gt; [61] "anno96_nttype64_annodata.txt" "anno96_nttype65_annodata.txt"</span></span>
<span><span class="co">#&gt; [63] "anno96_nttype66_annodata.txt" "anno96_nttype67_annodata.txt"</span></span>
<span><span class="co">#&gt; [65] "anno96_nttype68_annodata.txt" "anno96_nttype69_annodata.txt"</span></span>
<span><span class="co">#&gt; [67] "anno96_nttype7_annodata.txt"  "anno96_nttype70_annodata.txt"</span></span>
<span><span class="co">#&gt; [69] "anno96_nttype71_annodata.txt" "anno96_nttype72_annodata.txt"</span></span>
<span><span class="co">#&gt; [71] "anno96_nttype73_annodata.txt" "anno96_nttype74_annodata.txt"</span></span>
<span><span class="co">#&gt; [73] "anno96_nttype75_annodata.txt" "anno96_nttype76_annodata.txt"</span></span>
<span><span class="co">#&gt; [75] "anno96_nttype77_annodata.txt" "anno96_nttype78_annodata.txt"</span></span>
<span><span class="co">#&gt; [77] "anno96_nttype79_annodata.txt" "anno96_nttype8_annodata.txt" </span></span>
<span><span class="co">#&gt; [79] "anno96_nttype80_annodata.txt" "anno96_nttype81_annodata.txt"</span></span>
<span><span class="co">#&gt; [81] "anno96_nttype82_annodata.txt" "anno96_nttype83_annodata.txt"</span></span>
<span><span class="co">#&gt; [83] "anno96_nttype84_annodata.txt" "anno96_nttype85_annodata.txt"</span></span>
<span><span class="co">#&gt; [85] "anno96_nttype86_annodata.txt" "anno96_nttype87_annodata.txt"</span></span>
<span><span class="co">#&gt; [87] "anno96_nttype88_annodata.txt" "anno96_nttype89_annodata.txt"</span></span>
<span><span class="co">#&gt; [89] "anno96_nttype9_annodata.txt"  "anno96_nttype90_annodata.txt"</span></span>
<span><span class="co">#&gt; [91] "anno96_nttype91_annodata.txt" "anno96_nttype92_annodata.txt"</span></span>
<span><span class="co">#&gt; [93] "anno96_nttype93_annodata.txt" "anno96_nttype94_annodata.txt"</span></span>
<span><span class="co">#&gt; [95] "anno96_nttype95_annodata.txt" "anno96_nttype96_annodata.txt"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-diffdriver">Run diffdriver<a class="anchor" aria-label="anchor" href="#run-diffdriver"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(diffdriver)</span></span>
<span><span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="st">"~/temp/output"</span></span></code></pre></div>
<p>With signature adjustment (<code>BMRmode = "signature"</code>), which is the default mode, it will need around 20min to estimate parameters in background model. Please use the provided the annotation folder with 96-annotation files when running with the “signature mode”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">diffdriver</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffdriver.html">diffdriver</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">gene</span>, mut<span class="op">=</span> <span class="va">mut</span>, pheno <span class="op">=</span> <span class="va">pheno</span>, anno_dir <span class="op">=</span> <span class="st">"~/temp/annodir96"</span>, k<span class="op">=</span><span class="fl">6</span>, totalnttype <span class="op">=</span> <span class="fl">96</span>, BMRmode <span class="op">=</span> <span class="st">"signature"</span>, output_dir <span class="op">=</span> <span class="va">output_dir</span>, output_prefix <span class="op">=</span> <span class="st">"testdiffdriver_sig"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Infer parameters in background mutation rate model"</span></span>
<span><span class="co">#&gt; [1] "Start to prepare input data for target genes ..."</span></span>
<span><span class="co">#&gt; [1] "coding..."</span></span>
<span><span class="co">#&gt; [1] "processing ..."</span></span>
<span><span class="co">#&gt; [1] "for qnvars, filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "for cvars (0/1 categories), filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "normalizing categorical variables in annotation matrix ..."</span></span>
<span><span class="co">#&gt; [1] "Only keeping the first two columns of the phenotype data frame."</span></span>
<span><span class="co">#&gt; [1] "phenotype name is SmokingCessation"</span></span>
<span><span class="co">#&gt; [1] "number of samples shared in phenotype and mutation file: 40"</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: CHD4"</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: PIK3CA"</span></span>
<span><span class="co">#&gt; [1] "Finished."</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt;               dd.p      mlr.p   mlr.v2.p  fisher.p  binom.p      lr.p</span></span>
<span><span class="co">#&gt; CHD4   1.000000000 0.85864512 0.83477953 1.0000000 1.000000 0.7509494</span></span>
<span><span class="co">#&gt; PIK3CA 0.006751318 0.01370322 0.01300004 0.5576717 0.453489 0.1443223</span></span>
<span><span class="co">#&gt;            dd.fdr    mlr.fdr mlr.v2.fdr fisher.fdr binom.fdr    lr.fdr mut.E1</span></span>
<span><span class="co">#&gt; CHD4   1.00000000 0.85864512 0.83477953          1 1.0000000 0.7509494      5</span></span>
<span><span class="co">#&gt; PIK3CA 0.01350264 0.02740643 0.02600007          1 0.9069781 0.2886446      7</span></span>
<span><span class="co">#&gt;        mut.E0 E1 E0</span></span>
<span><span class="co">#&gt; CHD4        4 22 18</span></span>
<span><span class="co">#&gt; PIK3CA      9 22 18</span></span></code></pre></div>
<p>Without signature adjustment (<code>BMRmode = "regular"</code>), it will need around 20min to estimate parameters in background model. You can use the provided the annotation folder with 9-annotation files or 96-annotation files. The example below uses 96-annotation files. When total number of mutations is low, one should use 9-annotation files.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffdriver.html">diffdriver</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">gene</span>, mut<span class="op">=</span> <span class="va">mut</span>, pheno <span class="op">=</span> <span class="va">pheno</span>,  anno_dir <span class="op">=</span> <span class="st">"~/temp/annodir96"</span>, totalnttype <span class="op">=</span> <span class="fl">96</span>, BMRmode <span class="op">=</span> <span class="st">"regular"</span>, output_dir <span class="op">=</span> <span class="va">output_dir</span>, output_prefix <span class="op">=</span> <span class="st">"testdiffdriver_reg"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Infer parameters in background mutation rate model"</span></span>
<span><span class="co">#&gt; [1] "Start to prepare input data for target genes ..."</span></span>
<span><span class="co">#&gt; [1] "coding..."</span></span>
<span><span class="co">#&gt; [1] "processing ..."</span></span>
<span><span class="co">#&gt; [1] "for qnvars, filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "for cvars (0/1 categories), filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "normalizing categorical variables in annotation matrix ..."</span></span>
<span><span class="co">#&gt; [1] "Only keeping the first two columns of the phenotype data frame."</span></span>
<span><span class="co">#&gt; [1] "phenotype name is SmokingCessation"</span></span>
<span><span class="co">#&gt; [1] "number of samples shared in phenotype and mutation file: 40"</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: CHD4"</span></span>
<span><span class="co">#&gt; [1] "Start to process gene: PIK3CA"</span></span>
<span><span class="co">#&gt; [1] "Finished."</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt;              dd.p      mlr.p   mlr.v2.p  fisher.p  binom.p      lr.p    dd.fdr</span></span>
<span><span class="co">#&gt; CHD4   1.00000000 0.85864512 0.83477953 1.0000000 1.000000 0.7509494 1.0000000</span></span>
<span><span class="co">#&gt; PIK3CA 0.03021595 0.01370322 0.01300004 0.5576717 0.453489 0.1443223 0.0604319</span></span>
<span><span class="co">#&gt;           mlr.fdr mlr.v2.fdr fisher.fdr binom.fdr    lr.fdr mut.E1 mut.E0 E1 E0</span></span>
<span><span class="co">#&gt; CHD4   0.85864512 0.83477953          1 1.0000000 0.7509494      5      4 22 18</span></span>
<span><span class="co">#&gt; PIK3CA 0.02740643 0.02600007          1 0.9069781 0.2886446      7      9 22 18</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-specific-genes">Plot specific genes<a class="anchor" aria-label="anchor" href="#plot-specific-genes"></a>
</h2>
<p>To visualize the data for specific genes, diffdriver has a plotting function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">diffdriver</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mut.html">plot_mut</a></span><span class="op">(</span>gene_name <span class="op">=</span> <span class="st">"PIK3CA"</span>, mut<span class="op">=</span> <span class="va">mut</span>, pheno <span class="op">=</span> <span class="va">pheno</span>, totalnttype <span class="op">=</span> <span class="fl">9</span>, anno_dir <span class="op">=</span> <span class="st">"~/temp/annodir9"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "coding..."</span></span>
<span><span class="co">#&gt; [1] "processing ..."</span></span>
<span><span class="co">#&gt; [1] "for qnvars, filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "for cvars (0/1 categories), filling in missing values ..."</span></span>
<span><span class="co">#&gt; [1] "normalizing categorical variables in annotation matrix ..."</span></span>
<span><span class="co">#&gt; [1] "Only keeping the first two columns of the phenotype data frame."</span></span>
<span><span class="co">#&gt; [1] "phenotype name is SmokingCessation"</span></span>
<span><span class="co">#&gt; [1] "number of samples shared in phenotype and mutation file: 40"</span></span></code></pre></div>
<p><img src="diffdriver_tutorial_files/figure-html/plot-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.3 (2025-02-28)</span></span>
<span><span class="co">#&gt; Platform: x86_64-redhat-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Red Hat Enterprise Linux 8.10 (Ootpa)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS/LAPACK: /usr/lib64/libopenblaso-r0.3.15.so;  LAPACK version 3.9.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: America/New_York</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] diffdriver_0.1.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] cli_3.6.3          knitr_1.49         rlang_1.1.5        xfun_0.50         </span></span>
<span><span class="co">#&gt;  [5] textshaping_1.0.0  jsonlite_1.8.9     data.table_1.16.4  brglm_0.7.2       </span></span>
<span><span class="co">#&gt;  [9] SQUAREM_2021.1     htmltools_0.5.8.1  ragg_1.3.3         sass_0.4.9        </span></span>
<span><span class="co">#&gt; [13] rmarkdown_2.29     grid_4.4.3         profileModel_0.6.1 evaluate_1.0.3    </span></span>
<span><span class="co">#&gt; [17] jquerylib_0.1.4    fastmap_1.2.0      yaml_2.3.10        lifecycle_1.0.4   </span></span>
<span><span class="co">#&gt; [21] compiler_4.4.3     fs_1.6.5           htmlwidgets_1.6.4  systemfonts_1.2.1 </span></span>
<span><span class="co">#&gt; [25] lattice_0.22-6     digest_0.6.37      R6_2.5.1           bslib_0.9.0       </span></span>
<span><span class="co">#&gt; [29] Matrix_1.7-2       tools_4.4.3        pkgdown_2.1.1      cachem_1.1.0      </span></span>
<span><span class="co">#&gt; [33] desc_1.4.3</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Siming Zhao, Jie Zhou, Qirui Zhang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
